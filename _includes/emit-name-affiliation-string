{% comment %}
  emit-name-affiliation-string: emit a string of names and affiliations based on a set of person-ids

  arguments:
    `pids`: an array of person-ids to be used as keys
    `people`: an array of people records
    `if_empty`: alternate text to return if there are no (valid) pids

  Expected elements of person structure
    lastname (string)
    firstname (string)
    affiliations (array)
{% endcomment %}

{%- assign name_affiliation_array = "" | split: "," -%}
{%- if include.pids and include.pids != empty -%}
  {%- include set-name-affiliation-array pids=include.pids people=include.people -%}
{%- elsif include.if_empty -%}
  {%- assign name_affiliation_array = name_affiliation_array | push: include.if_empty -%}
{%- endif -%}
{%- if name_affiliation_array != empty -%}{{ name_affiliation_array | array_to_sentence_string }}{%- endif -%}
{%- comment -%}Clean up internal variables{%- endcomment -%}
{%- assign name_affiliation_array = nil -%}